<!DOCTYPE html>
<html>
<head>
    <title>Ø§Ø®ØªØ¨Ø§Ø± WhatsApp API</title>
    <meta charset="UTF-8">
    <style>
        body { font-family: Arial, sans-serif; padding: 20px; direction: rtl; }
        .container { max-width: 500px; margin: 0 auto; }
        input, textarea, button { width: 100%; padding: 10px; margin: 10px 0; font-size: 16px; }
        button { background: #25D366; color: white; border: none; cursor: pointer; }
        button:disabled { background: #ccc; }
        .result { padding: 10px; margin: 10px 0; border-radius: 5px; }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Ø§Ø®ØªØ¨Ø§Ø± WhatsApp API - BrandSoft Pay</h1>
        
        <input type="tel" id="phone" placeholder="+212708042619" value="+212708042619">
        <textarea id="message" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§...">ğŸ” Ø§Ø®ØªØ¨Ø§Ø± BrandSoft Pay

Ù…Ø±Ø­Ø¨Ø§Ù‹! Ù‡Ø°Ù‡ Ø±Ø³Ø§Ù„Ø© Ø§Ø®ØªØ¨Ø§Ø± Ù…Ù† Ù†Ø¸Ø§Ù… BrandSoft Pay.

âœ… WhatsApp API ÙŠØ¹Ù…Ù„ Ø¨Ø´ÙƒÙ„ ØµØ­ÙŠØ­
ğŸš€ Ø§Ù„Ù†Ø¸Ø§Ù… Ø¬Ø§Ù‡Ø² Ù„Ù„Ø§Ø³ØªØ®Ø¯Ø§Ù…

BrandSoft Pay - Ù…Ù†ØµØªÙƒ Ø§Ù„Ù…ØµØ±ÙÙŠØ© Ø§Ù„Ø¢Ù…Ù†Ø©</textarea>
        
        <button onclick="sendMessage()">Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© WhatsApp</button>
        
        <div id="result"></div>
    </div>

    <script>
        async function sendMessage() {
            const phone = document.getElementById('phone').value;
            const message = document.getElementById('message').value;
            const resultDiv = document.getElementById('result');
            const button = document.querySelector('button');
            
            if (!phone || !message) {
                showResult('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø±Ù‚Ù… Ø§Ù„Ù‡Ø§ØªÙ ÙˆØ§Ù„Ø±Ø³Ø§Ù„Ø©', 'error');
                return;
            }
            
            button.disabled = true;
            button.textContent = 'Ø¬Ø§Ø±Ù Ø§Ù„Ø¥Ø±Ø³Ø§Ù„...';
            
            try {
                const accessToken = "EAAQrRrLPFnMBOZCjlicG9mv99Sq4iESVFfZBc57wQtZCPGQGnSR14qCw7QNIg7i1Gfhun81GxOQo96M9ILlgr0geX5NrhD19w8BXZCCKHGSxeqzoRaTsAVJwbTrQZCx5EBgVVITAPOxdnqBZBfDUxikrCuwMCNli31nfghrEIuy6qV5ec07ZCWXhFhSUXZAc8JFLZB37BvOOTa1cr6W9uTDY6PkZCeXPmreVKzpD64qhXMZCyUOMO8KH3JkWmkmkDMfKwZDZD";
                const phoneNumberId = "637387286132641";
                
                const formattedPhone = phone.replace(/^\+/, '');
                
                const response = await fetch(`https://graph.facebook.com/v18.0/${phoneNumberId}/messages`, {
                    method: 'POST',
                    headers: {
                        'Authorization': `Bearer ${accessToken}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        messaging_product: 'whatsapp',
                        to: formattedPhone,
                        type: 'text',
                        text: {
                            body: message
                        }
                    })
                });
                
                if (response.ok) {
                    const result = await response.json();
                    showResult(`âœ… ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© Ø¨Ù†Ø¬Ø§Ø­!
                    
Ù…Ø¹Ø±Ù Ø§Ù„Ø±Ø³Ø§Ù„Ø©: ${result.messages[0]?.id}
Ø§Ù„Ø±Ù‚Ù… Ø§Ù„Ù…Ø³ØªÙ„Ù…: ${result.contacts[0]?.wa_id}

Ø¥Ø°Ø§ Ù„Ù… ØªØµÙ„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©ØŒ ØªØ£ÙƒØ¯ Ù…Ù†:
â€¢ Ø§Ù„Ø±Ù‚Ù… ÙŠÙ…Ù„Ùƒ WhatsApp
â€¢ ØªÙ… Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© Ù…Ù† Ù‡Ø°Ø§ Ø§Ù„Ø±Ù‚Ù… Ø¥Ù„Ù‰ +1 312-800-9268 Ù…Ù† Ù‚Ø¨Ù„`, 'success');
                } else {
                    const errorData = await response.text();
                    console.log('Error response:', errorData);
                    
                    let errorMessage = 'Ø®Ø·Ø£ ÙÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©';
                    
                    try {
                        const errorJson = JSON.parse(errorData);
                        if (errorJson.error?.code === 131047) {
                            errorMessage = 'Ù„Ø§ ÙŠÙ…ÙƒÙ† Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø© - ÙŠØ¬Ø¨ Ø£Ù† ÙŠØ±Ø³Ù„ Ø§Ù„Ù…Ø³ØªÙ„Ù… Ø±Ø³Ø§Ù„Ø© Ø¥Ù„Ù‰ +1 312-800-9268 Ø£ÙˆÙ„Ø§Ù‹';
                        } else if (errorJson.error?.message) {
                            errorMessage = errorJson.error.message;
                        }
                    } catch (e) {
                        errorMessage = `Ø®Ø·Ø£ ${response.status}: ${errorData}`;
                    }
                    
                    showResult(`âŒ ${errorMessage}`, 'error');
                }
                
            } catch (error) {
                console.error('Network error:', error);
                showResult(`âŒ Ø®Ø·Ø£ ÙÙŠ Ø§Ù„Ø´Ø¨ÙƒØ©: ${error.message}`, 'error');
            }
            
            button.disabled = false;
            button.textContent = 'Ø¥Ø±Ø³Ø§Ù„ Ø±Ø³Ø§Ù„Ø© WhatsApp';
        }
        
        function showResult(message, type) {
            const resultDiv = document.getElementById('result');
            resultDiv.className = `result ${type}`;
            resultDiv.innerHTML = message.replace(/\n/g, '<br>');
        }
    </script>
</body>
</html>