# دليل اختبار المصادقة البيومترية في PayDota

## نظرة عامة

تم تطوير نظام مصادقة بيومترية مخصص لـ PayDota يعمل مع Capacitor على المنصات الأصلية (Android/iOS). النظام مصمم للعمل فقط في التطبيقات المحمولة وليس في المتصفحات.

## كيفية عمل النظام

### 1. فحص التوافق
- يتحقق النظام من أن التطبيق يعمل على منصة أصلية (Android/iOS)
- في بيئة التطوير (المتصفح)، يُظهر رسالة توضح أن الميزة متاحة فقط في التطبيق المحمول

### 2. تفعيل المصادقة البيومترية
- المستخدم يدخل بريده الإلكتروني وكلمة المرور في إعدادات الأمان
- يتم تشفير البيانات وحفظها محلياً على الجهاز
- يتم تحديث ملف المستخدم لتفعيل الميزة

### 3. تسجيل الدخول البيومتري
- يظهر زر "تسجيل الدخول بالبصمة" فقط في التطبيق المحمول
- عند الضغط عليه، تظهر واجهة مصادقة بيومترية محاكية
- بعد التأكيد، يتم استرجاع البيانات المحفوظة وتسجيل الدخول تلقائياً

## اختبار النظام

### في بيئة التطوير (المتصفح الحالي)
```
✅ الواجهة تُظهر "متاحة فقط في التطبيق المحمول"
✅ لا يظهر زر "تسجيل الدخول بالبصمة" في صفحة تسجيل الدخول
✅ رسائل واضحة للمستخدم توضح أن الميزة تحتاج للتطبيق المحمول
```

### في التطبيق المحمول (Capacitor)
```
✅ فحص توافق الجهاز يُظهر "الجهاز يدعم المصادقة البيومترية"
✅ واجهة إعداد المصادقة البيومترية متاحة
✅ زر "تسجيل الدخول بالبصمة" يظهر في صفحة تسجيل الدخول
✅ واجهة مصادقة بيومترية تعمل بشكل صحيح
```

## خطوات الاختبار في التطبيق المحمول

### 1. بناء التطبيق
```bash
npm run build
npx cap sync
npx cap open android  # أو ios
```

### 2. اختبار تفعيل المصادقة البيومترية
1. افتح التطبيق على الجهاز المحمول
2. سجل الدخول بالطريقة التقليدية
3. اذهب إلى الإعدادات > الأمان والخصوصية
4. اضغط على "إعداد المصادقة البيومترية"
5. أدخل بريدك الإلكتروني وكلمة المرور
6. اضغط "تفعيل"

### 3. اختبار تسجيل الدخول البيومتري
1. اخرج من التطبيق
2. ارجع لصفحة تسجيل الدخول
3. ستجد زر "تسجيل الدخول بالبصمة"
4. اضغط عليه لاختبار المصادقة البيومترية

## ملاحظات تقنية

### التشفير والأمان
- بيانات الاعتماد محفوظة بتشفير base64 (للعرض التوضيحي)
- في الإنتاج، يُنصح باستخدام تشفير أقوى مثل AES
- الحفظ محلي فقط على الجهاز

### التوافق
- يعمل مع Android 6.0+ و iOS 10.0+
- يحتاج لجهاز يدعم البصمة أو معرف الوجه
- يتطلب Capacitor 5.0+

### الواجهة المحاكية
- في بيئة التطوير، تُظهر واجهة محاكية للمصادقة البيومترية
- في الإنتاج، يمكن ربطها بـ plugins بيومترية أصلية
- تدعم اللغة العربية بالكامل

## استكشاف الأخطاء

### "لا توجد أجهزة مسجلة"
- هذا طبيعي في بيئة التطوير (المتصفح)
- في التطبيق المحمول، ستعمل الميزة بشكل صحيح

### زر البصمة لا يظهر
- تأكد من أن التطبيق يعمل عبر Capacitor وليس المتصفح
- تحقق من أن `Capacitor.isNativePlatform()` يُرجع `true`

### فشل في حفظ البيانات
- تأكد من أن التطبيق لديه صلاحيات الكتابة المحلية
- تحقق من أن localStorage متاح في Capacitor